//>>built
require({cache:{"xnode/main":function(){define(["dojo/_base/kernel","xnode/manager/NodeServiceManager","xnode/manager/NodeServiceManagerUI","xnode/views/NodeServiceView","xnode/component"],function(g){return g.xnode})},"xnode/manager/NodeServiceManager":function(){define("dcl/dcl xide/manager/ServerActionBase xide/manager/BeanManager xide/types xide/factory xide/data/Memory xide/client/WebSocket xdojo/has xide/factory/Clients dojo/Deferred xdojo/has!xnode-ui?./NodeServiceManagerUI".split(" "),function(g,
d,l,m,f,k,h,n,b,a,e){d=[d,l];e&&d.push(e);return g(d,{declaredClass:"xnode.manager.NodeServiceManager",serviceClass:"XIDE_NodeJS_Service",cookiePrefix:"nodeJSServices",singleton:!0,serviceView:null,clients:null,beanNamespace:"serviceConsoleView",consoles:{},createClient:function(a){if(a.info){this.clients||(this.clients={});var c=this.getViewId(a);if(this.clients[c])return this.clients[c];var e=new h({});this.clients[c]=e;e.init({options:{host:a.info.host,port:a.info.port,debug:{all:!1,protocol_connection:!0,
protocol_messages:!0,socket_server:!0,socket_client:!0,socket_messages:!0,main:!0}}});e.connect();return e}console.error("NodeJs service has no host infos")},getStore:function(){return this.store},isValid:function(){return null!=this.store},initStore:function(a){return this.store=new k({data:{identifier:"name",label:"Name",items:a},idProperty:"name"})},init:function(){return this.ls()},getDefaults:function(a){return this.callMethodEx(null,"getDefaults",null,a,!0)},checkServer:function(a,c){return this.callMethodEx(null,
"checkServer",[a],c,!0)},runServer:function(a,c){return this.callMethodEx(null,"runDebugServer",[a],c,!0)},runDebug:function(a,c){return this.callMethodEx(null,"run",[a],c,!0)},stopServer:function(a,c){return this.callMethodEx(null,"stop",[a],c,!0)},startServer:function(a,c){return this.callMethodEx(null,"start",[a],c,!0)},ls:function(e,c,f){function b(a){d.rawData=a;d.initStore(a);!1!==f&&d.publish(m.EVENTS.ON_NODE_SERVICE_STORE_READY,{store:d.store});e&&e(a)}var d=this;c=null;if(this.services)return c=
new a,b(this.services),c.resolve(),c;c=this.runDeferred(null,"ls");try{c.then(function(a){b(a)})}catch(g){console.error("error loading store",g),logError(g,"error loading store")}return c}})})},"xnode/manager/NodeServiceManagerUI":function(){define("dcl/dcl dojo/_base/lang xide/encoding/MD5 xide/types xide/utils dojo/cookie dojo/json xdojo/has!xnode-ui?xide/views/ConsoleView xdojo/has!xnode-ui?xnode/views/NodeServiceView".split(" "),function(g,d,l,m,f,k,h,n,b){return g(null,{declaredClass:"xnode.manager.NodeServiceManagerUI",
getViewId:function(a){return this.beanNamespace+l(JSON.stringify({info:a.info}),1)},onConsoleEnter:function(a,e){if(0!=e.length){var b=a.view.client;d.isString(e)&&b.emit(null,e)}},createConsole:function(a,e,b){var c=this.getViewId(a);try{var d=f.addWidget(n,{delegate:this,title:a.name,closable:!0,style:"padding:0px;margin:0px;height:inherit",className:"runView",client:b,item:a},this,e,!0);this.consoles[c]=d;return b.delegate=d}catch(g){console.error(g)}},openConsole:function(a){this.getView(a);this.createConsole(a,
this.getViewTarget(),this.createClient(a))},onReload:function(){this.ls(function(){this.serviceView.refresh(this.store)}.bind(this))},loadPreferences:function(){var a=k(this.cookiePrefix+"_debug_settings");return a=a?h.parse(a):{}},savePreferences:function(a){k(this.cookiePrefix+"_debug_settings",h.stringify(a))},getViewTarget:function(){return this.ctx.getApplication().mainView.getNewAlternateTarget()},createServiceView:function(a,e){var d=e||this.getViewTarget();this.serviceView=f.addWidget(b,{delegate:this,
store:a,title:"Services",closable:!0,style:"padding:0px"},this,d,!0)},openServiceView:function(){if(this.isValid())this.createServiceView(this.store);else{var a=this;this.ls(function(){a.createServiceView(a.store)})}},onStart:function(a,e,b){a=[];for(b=0;b<e.length;b++)a.push(e[b].name);this.startServer(a,function(){this.onReload()}.bind(this))},onStop:function(a,e,b){a=[];for(b=0;b<e.length;b++)a.push(e[b].name);this.stopServer(a,function(){this.onReload()}.bind(this))},onMainMenuOpen:function(a){a=
a.menu;a.serviceMenuItem||a.name!=m.MAIN_MENU_KEYS.VIEWS||(a.serviceMenuItem=new dijit.MenuItem({label:"Services",onClick:d.hitch(this,"openServiceView")}),a.addChild(a.serviceMenuItem))},openServices:function(){this.openServiceView()},getActions:function(){return[]},init:function(){this.ctx.addActions(this.getActions())}})})},"xnode/views/NodeServiceView":function(){define("dcl/dcl dojo/_base/declare dgrid/OnDemandGrid dgrid/Selection xide/types xide/utils xaction/Action xide/layout/Container".split(" "),
function(g,d,l,m,f,k,h,n){return g(n,{declaredClass:"xide.views.NodeServiceView",delegate:null,store:null,cssClass:"layoutContainer normalizedGridView",createWidgets:function(b){b=new (d([l,m,"Keyboard"]))({collection:b,columns:{Name:{field:"name",label:"Name",sortable:!0},Status:{field:"status",label:"Status",sortable:!0,formatter:function(a){var b='\x3cdiv style\x3d"color:${color}"\x3e'+k.capitalize(a)+"\x3c/div\x3e";return k.substituteString(b,{color:"offline"==a?"red":"green"})}},Clients:{field:"clients",
label:"Clients",sortable:!0}}},this.containerNode);b.refresh();this.grid=b;this.onGridCreated(b)},startup:function(){this.inherited(arguments);this.store&&this.createWidgets(this.store)},hasItemActions:function(){return null!=this.getCurrentSelection(!0)},getItem:function(){return this.getCurrentSelection(!0)},getItemActions:function(){var b=this.getItem()[0],a=[],e=this.delegate,d=b.status===f.SERVICE_STATUS.ONLINE,c=b.status==f.SERVICE_STATUS.OFFLINE?"start":"stop",g=b.status==f.SERVICE_STATUS.OFFLINE?
"Start":"Stop",c=h.createDefault(g,b.status==f.SERVICE_STATUS.OFFLINE?"el-icon-play":"el-icon-stop","Edit/"+g,"xnode",null,{handler:!1!==b.can[c]?"start"==c?function(a,c,d){e.onStart(a,[b],d)}:function(a,c,d){e.onStop(a,[b],d)}:null}).setVisibility(f.ACTION_VISIBILITY.ACTION_TOOLBAR,{label:""}).setVisibility(f.ACTION_VISIBILITY.MAIN_MENU,{}).setVisibility(f.ACTION_VISIBILITY.CONTEXT_MENU,{});a.push(c);c=h.createDefault("Reload","fa-refresh","Edit/Reload","xnode",null,{handler:function(){e.onReload()}}).setVisibility(f.ACTION_VISIBILITY.ACTION_TOOLBAR,
{label:""}).setVisibility(f.ACTION_VISIBILITY.MAIN_MENU,{}).setVisibility(f.ACTION_VISIBILITY.CONTEXT_MENU,{});a.push(c);d=h.createDefault("Console","el-icon-indent-left","View/Console","xnode",null,{handler:function(){e.openConsole(b)},widgetArgs:{disabled:!d}}).setVisibility(f.ACTION_VISIBILITY.ACTION_TOOLBAR,{label:""}).setVisibility(f.ACTION_VISIBILITY.MAIN_MENU,{}).setVisibility(f.ACTION_VISIBILITY.CONTEXT_MENU,{});a.push(d);return 0==a.length?null:a}})})},"xnode/component":function(){define(["dojo/_base/declare",
"xide/model/Component"],function(g,d){return g([d],{beanType:"NODE_SERVICE",hasEditors:function(){return["xnode"]},getDependencies:function(){return["xide/xide","xnode/types","xnode/manager/NodeServiceManager","xnode/views/NodeServiceView"]},getLabel:function(){return"xnode"},getBeanType:function(){return this.beanType}})})},"xnode/types":function(){define([],function(){return null})}}});
//# sourceMappingURL=xnode.js.map